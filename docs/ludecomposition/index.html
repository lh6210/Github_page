


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hang's Math Notes</title>
    <!-- Required meta tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- put configuration ahead of loading statements -->
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'],['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        processHtmlClass: "arithmatex"
      }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>

    
    

</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-primary bg-opacity-10 text-dark">
  <div class="container-fluid">
      <a class="navbar-brand" href="/">Hang's Math Notes | Home</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse"  id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto mb-2 mx-5 mb-lg-0 ">
        <li class="nav-item">
            <a class="nav-link" href= "/others/" >Others</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href= "/knots/" >Knots</a>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#">About</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    
    
    <div class="container-fluid">
        <p>
            <h4> LU Decomposition of matrices </h4>
            <small> &#128197Published on October 30, 2021   &#9749Keywords: LUdecomposition, Sympy  </small> 
        </p>
        
        <p>--&gt; <a href="#disc">Discussions</a> * 2 </p>
<p>--&gt; <a href="#lab">Lab</a> * 2 </p>
<hr />
<h5 id="disc">Discussions</h5>
<p>&#128037;   1)  </p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{flalign}
&amp; \text{ Why } L_{31}  = \left( \begin{smallmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{smallmatrix} \right) \,
\text{and} \, 
E_{31} = \left( \begin{smallmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{smallmatrix} \right) \,
\text{are inverse to each other?}   &amp;
\end{flalign}</div>
<script type="math/tex; mode=display">\begin{flalign}
& \text{ Why } L_{31}  = \left( \begin{smallmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{smallmatrix} \right) \,
\text{and} \, 
E_{31} = \left( \begin{smallmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{smallmatrix} \right) \,
\text{are inverse to each other?}   &
\end{flalign}</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\( \because \)
\begin{flalign}  
L_{31} * E_{31} &amp;= 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix} 
*
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{bmatrix}
= I  &amp; \\
\\
\text{Or} \\
\\
L_{31} * E_{31} * A &amp;= 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
&amp; \text{row 1}&amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3}&amp; 
\end{bmatrix}_{\text{Matrix A}} &amp; \\
&amp;=
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
&amp; \text{row 1} &amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3 } - l_{31} * \text{row 1}&amp; 
\end{bmatrix}  \\
&amp;=
\begin{bmatrix}
&amp; \text{row 1}&amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3}&amp; 
\end{bmatrix}_{\text{Matrix A}} = A \\
\end{flalign}
</div>
<script type="math/tex; mode=display">
\( \because \)
\begin{flalign}  
L_{31} * E_{31} &= 
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix} 
*
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{bmatrix}
= I  & \\
\\
\text{Or} \\
\\
L_{31} * E_{31} * A &= 
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
& \text{row 1}& \\
& \text{row 2}& \\
& \text{row 3}& 
\end{bmatrix}_{\text{Matrix A}} & \\
&=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
& \text{row 1} & \\
& \text{row 2}& \\
& \text{row 3 } - l_{31} * \text{row 1}& 
\end{bmatrix}  \\
&=
\begin{bmatrix}
& \text{row 1}& \\
& \text{row 2}& \\
& \text{row 3}& 
\end{bmatrix}_{\text{Matrix A}} = A \\
\end{flalign}
</script>
</div>
<p>&#128037;  2) </p>
<p>Why does <span class="arithmatex"><span class="MathJax_Preview">$L=E_{21}^{-1}*E_{31}^{-1}*E_{32}^{-1}$</span><script type="math/tex">$L=E_{21}^{-1}*E_{31}^{-1}*E_{32}^{-1}$</script></span>
have advantage over <span class="arithmatex"><span class="MathJax_Preview">\(L^{-1} = E_{32}*E_{31} *E_{21}\)</span><script type="math/tex">\(L^{-1} = E_{32}*E_{31} *E_{21}\)</script></span>? </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\( \because \)
\begin{flalign}
  L^{-1} &amp;= E_{32}*E_{31} *E_{21} &amp;&amp;  \\
  &amp;= \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  0 &amp; 1 &amp; 0  \\
  0 &amp; -l_{32} &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  -l_{31} &amp; 0 &amp; 1 
  \end{bmatrix}  *
  \begin{bmatrix} 1 &amp; 0 &amp; 0 \\
  -l_{21} &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1
  \end{bmatrix}  &amp; \\ 
\phantom{L_{31} * E_{31} * A } &amp;= 
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  0 &amp; 1 &amp; 0  \\ 
  0 &amp; -l_{32} &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  -l_{21} &amp; 1 &amp; 0  \\
  -l_{31} &amp; 0 &amp; 1 
  \end{bmatrix} &amp;&amp;\text{Matrix multiplication mixed up all three numbers below.} \\
&amp;=
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  -l_{21} &amp; 1 &amp; 0  \\ 
  \underline{-l_{31} + l_{21} * l_{32}} &amp; -l_{32} &amp; 1  
  \end{bmatrix} &amp;&amp;\text{The entry at \(L^{-1}_{31}\) is an algebraic combination of three elements} \\
 \\ 
 \\
L &amp;= E_{21}^{-1} * E_{31}^{-1} *E_{32}^{-1} \\
  &amp;= \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  0 &amp; 0 &amp; 1  
  \end{bmatrix}  * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  l_{31} &amp; 0 &amp; 1 
  \end{bmatrix}  *
  \begin{bmatrix}
  1 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 \\
  0 &amp; l_{32} &amp; 1
  \end{bmatrix}  \\ 
&amp;= 
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  0 &amp; 0 &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  l_{31} &amp; l_{32} &amp; 1 
  \end{bmatrix}   \\
&amp;=
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  l_{31} &amp; l_{32} &amp; 1  
  \end{bmatrix}   &amp;&amp;\text{Each multiplier \(l_{ij}\) goes directly into its i, j position unchanged, which is what we like.} &amp;&amp; \phantom{a^2}
\end{flalign}
</div>
<script type="math/tex; mode=display">
\( \because \)
\begin{flalign}
  L^{-1} &= E_{32}*E_{31} *E_{21} &&  \\
  &= \begin{bmatrix}
  1 & 0 & 0   \\  
  0 & 1 & 0  \\
  0 & -l_{32} & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  -l_{31} & 0 & 1 
  \end{bmatrix}  *
  \begin{bmatrix} 1 & 0 & 0 \\
  -l_{21} & 1 & 0 \\
  0 & 0 & 1
  \end{bmatrix}  & \\ 
\phantom{L_{31} * E_{31} * A } &= 
  \begin{bmatrix}
  1 & 0 & 0   \\  
  0 & 1 & 0  \\ 
  0 & -l_{32} & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  -l_{21} & 1 & 0  \\
  -l_{31} & 0 & 1 
  \end{bmatrix} &&\text{Matrix multiplication mixed up all three numbers below.} \\
&=
  \begin{bmatrix}
  1 & 0 & 0   \\  
  -l_{21} & 1 & 0  \\ 
  \underline{-l_{31} + l_{21} * l_{32}} & -l_{32} & 1  
  \end{bmatrix} &&\text{The entry at \(L^{-1}_{31}\) is an algebraic combination of three elements} \\
 \\ 
 \\
L &= E_{21}^{-1} * E_{31}^{-1} *E_{32}^{-1} \\
  &= \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  0 & 0 & 1  
  \end{bmatrix}  * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  l_{31} & 0 & 1 
  \end{bmatrix}  *
  \begin{bmatrix}
  1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & l_{32} & 1
  \end{bmatrix}  \\ 
&= 
  \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  0 & 0 & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  l_{31} & l_{32} & 1 
  \end{bmatrix}   \\
&=
  \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  l_{31} & l_{32} & 1  
  \end{bmatrix}   &&\text{Each multiplier \(l_{ij}\) goes directly into its i, j position unchanged, which is what we like.} && \phantom{a^2}
\end{flalign}
</script>
</div>
<hr />
<h3 id="lab">Labs</h3>
<p>1) &#128037;  Modify Sympy's LUdecomposition method so that it returns L, D, U instead of just L and U.</p>
<p>According to <a href="https://docs.sympy.org/latest/index.html">Sympy</a>'s document, <a href="https://docs.sympy.org/latest/modules/matrices/matrices.html#matrix-functions-reference">LUdecomposition</a> could factor out a given matrix.</p>
<p>Example: </p>
<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #204a87; font-weight: bold">from</span> <span style="color: #000000">sympy.interactive.printing</span> <span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000">init_printing</span>  <span style="color: #8f5902; font-style: italic"># line 1~4 set up the environment for computing</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">init_printing</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">use_unicode</span><span style="color: #ce5c00; font-weight: bold">=</span><span style="color: #204a87; font-weight: bold">True</span><span style="color: #000000; font-weight: bold">)</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #204a87; font-weight: bold">from</span> <span style="color: #000000">sympy.matrices</span> <span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000">Matrix</span> 
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #204a87; font-weight: bold">from</span> <span style="color: #000000">sympy</span> <span style="color: #204a87; font-weight: bold">import</span> <span style="color: #000000">symbols</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">shape</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">eye</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">sympify</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">Rational</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">A</span> <span style="color: #ce5c00; font-weight: bold">=</span>  <span style="color: #000000">Matrix</span><span style="color: #000000; font-weight: bold">([[</span><span style="color: #0000cf; font-weight: bold">4</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">],</span> <span style="color: #000000; font-weight: bold">[</span><span style="color: #0000cf; font-weight: bold">6</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">]])</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">A</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">LUdecomposition</span><span style="color: #000000; font-weight: bold">()</span>
</code></pre></div>
<img alt="LUdecomposition" src="../static/lu1.png" /></p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">L</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">_</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">A</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">LUdecomposition</span><span style="color: #000000; font-weight: bold">()</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">L</span> <span style="color: #ce5c00; font-weight: bold">*</span> <span style="color: #000000">U</span> <span style="color: #ce5c00; font-weight: bold">==</span> <span style="color: #000000">A</span>
<span style="color: #204a87; font-weight: bold">True</span>
</code></pre></div>
<p>The leftmost matrix is L, the middle matrix is U, and the rightmost one is P. That P is blank just means that there's no row exchanges during the LU decomposition.</p>
<p>The motivation of this modification is that we want to see the symmetric matrix <span class="arithmatex"><span class="MathJax_Preview">\(S= L*D*U = L*D*L^T\)</span><script type="math/tex">\(S= L*D*U = L*D*L^T\)</script></span> more clearly.</p>
<p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #204a87; font-weight: bold">def</span> <span style="color: #000000">LU2</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">A</span><span style="color: #000000; font-weight: bold">):</span>
    <span style="color: #000000">L</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">P</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">A</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">LUdecomposition</span><span style="color: #000000; font-weight: bold">()</span>
    <span style="color: #000000">r</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">U</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">rank</span><span style="color: #000000; font-weight: bold">()</span>
    <span style="color: #000000">m</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">n</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">shape</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #000000">D</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">eye</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">)</span>
    <span style="color: #204a87; font-weight: bold">for</span> <span style="color: #000000">i</span> <span style="color: #204a87; font-weight: bold">in</span> <span style="color: #204a87">range</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">r</span><span style="color: #000000; font-weight: bold">):</span>
        <span style="color: #000000">pivot</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">[</span><span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">]</span>
        <span style="color: #000000">D</span><span style="color: #000000; font-weight: bold">[</span><span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">]</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">pivot</span>
        <span style="color: #204a87; font-weight: bold">for</span> <span style="color: #000000">j</span> <span style="color: #204a87; font-weight: bold">in</span> <span style="color: #204a87">range</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">n</span><span style="color: #000000; font-weight: bold">):</span>
            <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">[</span><span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">j</span><span style="color: #000000; font-weight: bold">]</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">[</span><span style="color: #000000">i</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">j</span><span style="color: #000000; font-weight: bold">]</span> <span style="color: #ce5c00; font-weight: bold">/</span> <span style="color: #000000">sympify</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">pivot</span><span style="color: #000000; font-weight: bold">)</span>    <span style="color: #8f5902; font-style: italic"># sympify makes the quotient of the two integers an exact rational number</span>
    <span style="color: #204a87; font-weight: bold">return</span> <span style="color: #000000">L</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">D</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">U</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #000000">P</span>
</code></pre></div>
Here's the result of LUdecomposition:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">B</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">Matrix</span><span style="color: #000000; font-weight: bold">([[</span><span style="color: #0000cf; font-weight: bold">1</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">0</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">],</span> <span style="color: #000000; font-weight: bold">[</span><span style="color: #ce5c00; font-weight: bold">-</span><span style="color: #0000cf; font-weight: bold">2</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">5</span><span style="color: #000000; font-weight: bold">],</span> <span style="color: #000000; font-weight: bold">[</span><span style="color: #000000">Rational</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #0000cf; font-weight: bold">1</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">),</span> <span style="color: #0000cf; font-weight: bold">0</span><span style="color: #000000; font-weight: bold">,</span> <span style="color: #ce5c00; font-weight: bold">-</span><span style="color: #0000cf; font-weight: bold">3</span><span style="color: #000000; font-weight: bold">]])</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">S</span> <span style="color: #ce5c00; font-weight: bold">=</span> <span style="color: #000000">B</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">T</span><span style="color: #ce5c00; font-weight: bold">*</span><span style="color: #000000">B</span>    <span style="color: #8f5902; font-style: italic"># this step makes a symmetric matrix S; another trick is B*B.T</span>
<span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">S</span><span style="color: #ce5c00; font-weight: bold">.</span><span style="color: #000000">LUdecomposition</span><span style="color: #000000; font-weight: bold">()</span> 
</code></pre></div>
<img alt="LU2" src="../static/lu2.png" /></p>
<p>Here's the result of LU2's output:
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #ce5c00; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #000000">LU2</span><span style="color: #000000; font-weight: bold">(</span><span style="color: #000000">S</span><span style="color: #000000; font-weight: bold">)</span>
</code></pre></div>
<img alt="lu3" src="../static/lu3_2.png" /></p>
<p>In this particular case (check symmetric matrices' <span class="arithmatex"><span class="MathJax_Preview">\(L*D*L^T \)</span><script type="math/tex">\(L*D*L^T \)</script></span> decomposition), we could see clearly that the rightmost matrix is the transpose of L (the leftmost matrix).</p>
<p>2) &#128037; LUdecompose rectangular shaped matrices A </p>
<p>Sympy's LUdecomposition is a really sharp tool that it deals with both square and rectangular matrices. While we may not find decomposing rectangular matrics productive, let's just play for fun. </p>
<p>For this practice, I picked one 2 by 3 matrix A and one 3 by 2 matrix B. I am going to use both Sympy's LUdecomposition and our lightly modified LU2 method to see the matrix decomposition again.</p>
<p><img alt="rectangular matrices" src="../static/lu4_2.png" /></p>
<p><img alt="rect matrics2" src="../static/lu5_2.png" /></p>
<p>One takeaway I got from this experiment is that A and D seem to share the same shape and rank, while L is always square and full rank.</p>
<p>This is the end of this article, and thanks for reading.</p>

        <!-- comment box -->
        <script src="https://utteranc.es/client.js"
                repo="lh6210/lh6210.github.io"
                issue-term="title"
                label="comment"
                theme="github-light"
                crossorigin="anonymous"
                async>
        </script>

    </div>





</body>
</html>