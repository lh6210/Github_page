


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Flask Blog</title>

    <link rel="stylesheet" href="static/styles.css">
    <!-- put configuration ahead of loading statements -->
    <!--
    <script>
    MathJax = {
      tex: {
        inlineMath: [['\(', '\)']],
        displayMath: [['$$', '$$'], ['\[', '\]']],
      }
    };
    </script>
    -->
    <script>
    window.MathJax = {
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process',
        renderActions: {
          find: [10, function (doc) {
            for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              const sibling = node.previousElementSibling;
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
              if (sibling && sibling.matches('.MathJax_Preview')) {
                sibling.parentNode.removeChild(sibling);
              }
            }
          }, '']
        }
      }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
    <!-- MathJax 3 -->
    <!-- support old browsers polyfill 
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    -->
</head>
<body>
    <h1>My Common Header</h1>
    
    
    <h1> LU Decomposition </h1>
    <!-- <small> Published on Saturday, 30 October, 2021</small> -->
    <br><br>
<p><a href="#head">link to Head 1</a></p>
<p>&#128037;   <span class="arithmatex"><span class="MathJax_Preview">\begin{flalign}
&amp; \text{ Why } L_{31}  = \left( \begin{smallmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{smallmatrix} \right) \,
\text{and} \, 
E_{31} = \left( \begin{smallmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{smallmatrix} \right) \,
\text{are inverse to each other?}  &amp;
\end{flalign}</span><script type="math/tex">\begin{flalign}
& \text{ Why } L_{31}  = \left( \begin{smallmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{smallmatrix} \right) \,
\text{and} \, 
E_{31} = \left( \begin{smallmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{smallmatrix} \right) \,
\text{are inverse to each other?}  &
\end{flalign}</script></span></p>
<div class="arithmatex">
<div class="MathJax_Preview">
\because 
\begin{flalign}  
L_{31} * E_{31} &amp;= 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix} 
*
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{bmatrix}
= I  &amp; \\
\\
\text{Or} \\
\\
L_{31} * E_{31} * A &amp;= 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
-l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
&amp; \text{row 1}&amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3}&amp; 
\end{bmatrix}_{\text{Matrix A}} &amp; \\
&amp;=
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
l_{31} &amp; 0 &amp; 1
\end{bmatrix}
*
\begin{bmatrix}
&amp; \text{row 1} &amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3 } - l_{31} * \text{row 1}&amp; 
\end{bmatrix}  \\
&amp;=
\begin{bmatrix}
&amp; \text{row 1}&amp; \\
&amp; \text{row 2}&amp; \\
&amp; \text{row 3}&amp; 
\end{bmatrix}_{\text{Matrix A}} = A \\
\end{flalign}
</div>
<script type="math/tex; mode=display">
\because 
\begin{flalign}  
L_{31} * E_{31} &= 
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix} 
*
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{bmatrix}
= I  & \\
\\
\text{Or} \\
\\
L_{31} * E_{31} * A &= 
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
-l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
& \text{row 1}& \\
& \text{row 2}& \\
& \text{row 3}& 
\end{bmatrix}_{\text{Matrix A}} & \\
&=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_{31} & 0 & 1
\end{bmatrix}
*
\begin{bmatrix}
& \text{row 1} & \\
& \text{row 2}& \\
& \text{row 3 } - l_{31} * \text{row 1}& 
\end{bmatrix}  \\
&=
\begin{bmatrix}
& \text{row 1}& \\
& \text{row 2}& \\
& \text{row 3}& 
\end{bmatrix}_{\text{Matrix A}} = A \\
\end{flalign}
</script>
</div>
<p>&#128037; </p>
<p>Why does <span class="arithmatex"><span class="MathJax_Preview">L=E_{21}^{-1}*E_{31}^{-1}*E_{32}^{-1}</span><script type="math/tex">L=E_{21}^{-1}*E_{31}^{-1}*E_{32}^{-1}</script></span>
have advantage over <span class="arithmatex"><span class="MathJax_Preview">L^{-1} = E_{32}*E_{31} *E_{21}</span><script type="math/tex">L^{-1} = E_{32}*E_{31} *E_{21}</script></span>? </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{alignat}{2}
 L^{-1} &amp;= E_{32}*E_{31} *E_{21}  \\
  &amp;= \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  0 &amp; 1 &amp; 0  \\
  0 &amp; -l_{32} &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  -l_{31} &amp; 0 &amp; 1 
  \end{bmatrix}  *
  \begin{bmatrix} 1 &amp; 0 &amp; 0 \\
  -l_{21} &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1
  \end{bmatrix}  &amp; \\ 
&amp;= 
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  0 &amp; 1 &amp; 0  \\ 
  0 &amp; -l_{32} &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  -l_{21} &amp; 1 &amp; 0  \\
  -l_{31} &amp; 0 &amp; 1 
  \end{bmatrix} &amp;&amp;\quad &amp;&amp;\text{Matrix multiplication mixed up all three numbers below.} \\
&amp;=
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  -l_{21} &amp; 1 &amp; 0  \\ 
  \underline{-l_{31} + l_{21} * l_{32}} &amp; -l_{32} &amp; 1  
  \end{bmatrix} &amp;&amp;\quad &amp;&amp;\text{The entry at \(L^{-1}_{31}\) is an arithmetic combination of three elements} \\
 \\ 
 \\
L &amp;= E_{21}^{-1} * E_{31}^{-1} *E_{32}^{-1} \\
  &amp;= \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  0 &amp; 0 &amp; 1  
  \end{bmatrix}  * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  l_{31} &amp; 0 &amp; 1 
  \end{bmatrix}  *
  \begin{bmatrix}
  1 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 \\
  0 &amp; l_{32} &amp; 1
  \end{bmatrix}  \\ 
&amp;= 
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  0 &amp; 0 &amp; 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 &amp; 0 &amp; 0  \\
  0 &amp; 1 &amp; 0  \\
  l_{31} &amp; l_{32} &amp; 1 
  \end{bmatrix}   \\
&amp;=
  \begin{bmatrix}
  1 &amp; 0 &amp; 0   \\  
  l_{21} &amp; 1 &amp; 0  \\ 
  l_{31} &amp; l_{32} &amp; 1  
  \end{bmatrix}   &amp;&amp;\quad &amp;&amp;\text{Each multiplier \(l_{ij}\) goes directly into its i, j position unchanged, which is what we like.}
\end{alignat}
</div>
<script type="math/tex; mode=display">
\begin{alignat}{2}
 L^{-1} &= E_{32}*E_{31} *E_{21}  \\
  &= \begin{bmatrix}
  1 & 0 & 0   \\  
  0 & 1 & 0  \\
  0 & -l_{32} & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  -l_{31} & 0 & 1 
  \end{bmatrix}  *
  \begin{bmatrix} 1 & 0 & 0 \\
  -l_{21} & 1 & 0 \\
  0 & 0 & 1
  \end{bmatrix}  & \\ 
&= 
  \begin{bmatrix}
  1 & 0 & 0   \\  
  0 & 1 & 0  \\ 
  0 & -l_{32} & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  -l_{21} & 1 & 0  \\
  -l_{31} & 0 & 1 
  \end{bmatrix} &&\quad &&\text{Matrix multiplication mixed up all three numbers below.} \\
&=
  \begin{bmatrix}
  1 & 0 & 0   \\  
  -l_{21} & 1 & 0  \\ 
  \underline{-l_{31} + l_{21} * l_{32}} & -l_{32} & 1  
  \end{bmatrix} &&\quad &&\text{The entry at \(L^{-1}_{31}\) is an arithmetic combination of three elements} \\
 \\ 
 \\
L &= E_{21}^{-1} * E_{31}^{-1} *E_{32}^{-1} \\
  &= \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  0 & 0 & 1  
  \end{bmatrix}  * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  l_{31} & 0 & 1 
  \end{bmatrix}  *
  \begin{bmatrix}
  1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & l_{32} & 1
  \end{bmatrix}  \\ 
&= 
  \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  0 & 0 & 1  
  \end{bmatrix} * 
\begin{bmatrix}
  1 & 0 & 0  \\
  0 & 1 & 0  \\
  l_{31} & l_{32} & 1 
  \end{bmatrix}   \\
&=
  \begin{bmatrix}
  1 & 0 & 0   \\  
  l_{21} & 1 & 0  \\ 
  l_{31} & l_{32} & 1  
  \end{bmatrix}   &&\quad &&\text{Each multiplier \(l_{ij}\) goes directly into its i, j position unchanged, which is what we like.}
\end{alignat}
</script>
</div>
<h1>LU Factorization</h1>
<p>Let's have a look at how \(L * U\) works, specifically \(E_{21} * E_{31} * E_{32} * U\).  <br />
We are taking a 3 by 3 matrix for this demonstration.</p>
<p>Given $ A = \begin{bmatrix}
2 &amp; 1 \\
6 &amp; 8 \end{bmatrix}$</p>
<div class="highlight"><pre><span></span><code>from sympy.interactive.printing import init_printing
init_printing(use_unicode=True)
from sympy.matrices import Matrix 
from sympy import symbols, shape, eye, sympify


def LU2(A):
    L, U, P = A.LUdecomposition()
    r = U.rank()
    m, n = shape(U)
    D = eye(r)
    for i in range(r):
        pivot = U[i, i]
        D[i, i] = pivot
        for j in range(i, n):
            U[i, j] = U[i, j] / sympify(pivot)
    return L, D, U, P
</code></pre></div>
<p>Inline <code>code</code> has <code>back-ticks around</code> it.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">fancyAlert</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{</span>   
  <span class="k">if</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{</span>   
    <span class="nx">$</span><span class="p">.</span><span class="nx">facebox</span><span class="p">({</span><span class="nx">div</span><span class="o">:</span><span class="s1">&#39;#foo&#39;</span><span class="p">})</span>    
  <span class="p">}</span>   
<span class="p">}</span>   
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sympy.interactive.printing</span> <span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sympy.matrices</span> <span class="kn">import</span> <span class="n">Matrix</span> 
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">eye</span><span class="p">,</span> <span class="n">sympify</span>


<span class="k">def</span> <span class="nf">LU2</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LUdecomposition</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pivot</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">sympify</span><span class="p">(</span><span class="n">pivot</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">L</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">P</span>
</code></pre></div>
<h3 id="head">head</h3>
<h2 id="head-1">head 1</h2>
<h3 id="head-2">head 2</h3>
<h5>head 3</h5>
<p><span class="arithmatex"><span class="MathJax_Preview">y = x^2</span><script type="math/tex">y = x^2</script></span>
When <span class="arithmatex"><span class="MathJax_Preview">a \ne 0</span><script type="math/tex">a \ne 0</script></span>, there are two solutions to <span class="arithmatex"><span class="MathJax_Preview">ax^2 + bx+c=0</span><script type="math/tex">ax^2 + bx+c=0</script></span> and they are <span class="arithmatex"><span class="MathJax_Preview">x = {-b \pm \sqrt{b^2 - 4ac} \over 2a}.</span><script type="math/tex">x = {-b \pm \sqrt{b^2 - 4ac} \over 2a}.</script></span>
Here's the $.</p>
<p><span class="arithmatex">\(p(x|y) = \frac{p(y|x)p(x)}{p(y)}\)</span></p>
<p>LUdecomposition with Sympy</p>
<div class="arithmatex">
<div class="MathJax_Preview">\begin{bmatrix}
1 &amp; 2 &amp; 3 \\
a &amp; b &amp; c
\end{bmatrix}</div>
<script type="math/tex; mode=display">\begin{bmatrix}
1 & 2 & 3 \\
a & b & c
\end{bmatrix}</script>
</div>






</body>
</html>